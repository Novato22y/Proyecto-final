<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pomodoro - EduNote</title>
    <link rel="icon" type="image/svg+xml" href="{{ url_for('static', filename='images/logoedunote.ico') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
</head>
<body>
    {% include '_sidebar.html' %}

    <div class="contenedor-principal">
        <div class="columna-calendario">
            <div class="calendar-app">
                <!-- Bloque central blanco con curvas similar a prueba -->
                <div class="pomodoro-card">
                    <h2>Pomodoro</h2>
                    <div class="pomodoro-display">
                        <div class="time" id="pomodoro-time">25:00</div>
                        <div class="controls">
                            <button id="start-btn">Iniciar</button>
                            <button id="pause-btn">Pausa</button>
                               <button id="reset-btn" class="btn">Reiniciar</button>
                               <button id="next-phase-btn" class="btn">Siguiente fase</button>
                        </div>
                    </div>

                    <div class="presets-list">
                        <h4>Presets</h4>
                        <div id="presets-container"></div>
                            <div style="display:flex;gap:8px;align-items:center;">
                                <button id="add-preset-btn">Agregar preset</button>
                                <button id="open-config">Editar presets / Música</button>
                            </div>
                    </div>

                    <div class="mini-music-box">
                        <h5>Música (YouTube links)</h5>
                        <div id="music-links" class="tags-container"></div>
                        <div class="input-with-add">
                            <input type="text" id="music-link-input" placeholder="https://youtu.be/...">
                            <button id="add-music-link">+</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de configuración Pomodoro -->
    <div id="pomodoro-modal" class="modal">
        <div class="modal-content">
            <span class="close-btn" id="close-pomodoro-modal">&times;</span>
            <h3>Configuración Pomodoro</h3>

            <form id="pomodoro-config-form">
                <label>Nombre del preset:</label>
                <input type="text" id="preset-name" placeholder="Trabajo 25/5">

                <label>Work (min):</label>
                <input type="number" id="preset-work" min="1" value="25">

                <label>Short break (min):</label>
                <input type="number" id="preset-short" min="1" value="5">

                <label>Long break (min):</label>
                <input type="number" id="preset-long" min="1" value="15">

                <label>Color Work:</label>
                <input type="color" id="color-work" value="#f56565">

                <label>Color Short Break:</label>
                <input type="color" id="color-short" value="#f6ad55">

                <label>Color Long Break:</label>
                <input type="color" id="color-long" value="#48bb78">

                <div class="form-section">
                    <h4>Música (YouTube links)</h4>
                    <div id="config-music-links" class="tags-container"></div>
                    <div class="input-with-add">
                        <input type="text" id="config-music-input" placeholder="https://youtu.be/...">
                        <button type="button" id="config-add-music">+</button>
                    </div>
                </div>

                <div class="form-section">
                    <h4>Alarma</h4>
                    <label for="alarm-url">URL de alarma (mp3/ogg):</label>
                    <input type="text" id="alarm-url" placeholder="https://.../alarm.mp3" />
                    <div style="display:flex;gap:8px;margin-top:8px;">
                        <button type="button" id="test-alarm">Probar sonido</button>
                        <button type="button" id="save-alarm">Guardar alarma</button>
                    </div>
                </div>
                <div class="form-section">
                    <h4> Ciclos y Long Break </h4>
                    <label for="cycles-before-long">Ciclos de trabajo antes de Long Break:</label>
                    <input type="number" id="cycles-before-long" min="1" value="4" />
                    <div style="margin-top:8px;">
                        <small>Ej: 4 = después de 4 work → long</small>
                    </div>
                </div>

                <div style="display:flex;gap:8px;margin-top:12px;">
                    <button type="button" id="save-preset">Guardar preset</button>
                    <button type="button" id="delete-preset">Eliminar preset</button>
                </div>
            </form>

            <hr>
            <div>
                <h4>Presets guardados</h4>
                <div id="config-presets-list"></div>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/pomodoro.js') }}"></script>
    <script>
    {% if current_user and current_user.is_authenticated %}
    window.APP_USER_ID = {{ current_user.id | tojson }};
    {% else %}
    window.APP_USER_ID = null;
    {% endif %}
    </script>
</body>
</html>
